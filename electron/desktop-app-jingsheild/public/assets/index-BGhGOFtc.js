import{j as c,aF as _e,aG as Ae,R,S as re,s as Ie,al as je,a9 as Ne,aH as ze,aI as Le,ag as Ve,aJ as Fe,t as He,v as Ke,k as T,aa as Ge,d as Ye,aK as We,a4 as Re,l as me,y as ve,aj as V,ak as pe,an as ye,aL as Xe,q as Ue,r as M,o as f,E as D,w as A,ae as Je,Y as Z,c as E,P as Q,a as I,X as Ce,z as O,C as x,Z as ee,B as v,e as oe,ad as ge,A as le,h as ne,G as te,aM as qe,aN as Ze,aO as ae,aP as be,H as Qe,J as xe,D as eo}from"./index-DM9u3KzT.js";import{C as oo,u as lo,a as no}from"./use-teleport-container-C4MI57Bu.js";import{B as to}from"./index-BY_Z3AGv.js";import{K as ao}from"./keyboard-DgN-yNuq.js";import{o as so}from"./index-JRQQbpTd.js";const io=e=>{const o=c(!1),l={overflow:"",width:"",boxSizing:""};return{setOverflowHidden:()=>{if(e.value){const n=e.value;if(!o.value&&n.style.overflow!=="hidden"){const i=_e(n);(i>0||Ae(n))&&(l.overflow=n.style.overflow,l.width=n.style.width,l.boxSizing=n.style.boxSizing,n.style.overflow="hidden",n.style.width=`${n.offsetWidth-i}px`,n.style.boxSizing="border-box",o.value=!0)}}},resetOverflow:()=>{if(e.value&&o.value){const n=e.value;n.style.overflow=l.overflow,n.style.width=l.width,n.style.boxSizing=l.boxSizing,o.value=!1}}}},ro=({modalRef:e,wrapperRef:o,draggable:l,alignCenter:d})=>{const r=c(!1),n=c([0,0]),i=c([0,0]),p=c(),y=c([0,0]),t=c([0,0]),u=()=>{var s,B,S;if(o.value&&e.value){const{top:w,left:k}=o.value.getBoundingClientRect(),{clientWidth:F,clientHeight:H}=o.value,{top:j,left:K,width:N,height:z}=e.value.getBoundingClientRect(),P=d.value?0:(s=e.value)==null?void 0:s.offsetTop,C=K-k,G=j-w-P;(C!==((B=i.value)==null?void 0:B[0])||G!==((S=i.value)==null?void 0:S[1]))&&(i.value=[C,G]);const L=F>N?F-N:0,Y=H>z?H-z-P:0;(L!==t.value[0]||Y!==t.value[1])&&(t.value=[L,Y]),P&&(y.value=[0,0-P])}},m=s=>{l.value&&(s.preventDefault(),r.value=!0,u(),n.value=[s.x,s.y],R(window,"mousemove",g),R(window,"mouseup",b),R(window,"contextmenu",b))},g=s=>{if(r.value){const B=s.x-n.value[0],S=s.y-n.value[1];let w=i.value[0]+B,k=i.value[1]+S;w<y.value[0]&&(w=y.value[0]),w>t.value[0]&&(w=t.value[0]),k<y.value[1]&&(k=y.value[1]),k>t.value[1]&&(k=t.value[1]),p.value=[w,k]}},b=()=>{r.value=!1,re(window,"mousemove",g),re(window,"mouseup",b)};return{position:p,handleMoveDown:m}};var uo=Object.defineProperty,we=Object.getOwnPropertySymbols,fo=Object.prototype.hasOwnProperty,co=Object.prototype.propertyIsEnumerable,ke=(e,o,l)=>o in e?uo(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,mo=(e,o)=>{for(var l in o||(o={}))fo.call(o,l)&&ke(e,l,o[l]);if(we)for(var l of we(o))co.call(o,l)&&ke(e,l,o[l]);return e},vo=Ie({name:"Modal",components:{ClientOnly:oo,ArcoButton:to,IconHover:je,IconClose:Ne,IconInfoCircleFill:ze,IconCheckCircleFill:Le,IconExclamationCircleFill:Ve,IconCloseCircleFill:Fe},inheritAttrs:!1,props:{visible:{type:Boolean,default:void 0},defaultVisible:{type:Boolean,default:!1},width:{type:[Number,String]},top:{type:[Number,String]},mask:{type:Boolean,default:!0},title:{type:String},titleAlign:{type:String,default:"center"},alignCenter:{type:Boolean,default:!0},unmountOnClose:Boolean,maskClosable:{type:Boolean,default:!0},hideCancel:{type:Boolean,default:!1},simple:{type:Boolean,default:e=>e.notice},closable:{type:Boolean,default:!0},okText:String,cancelText:String,okLoading:{type:Boolean,default:!1},okButtonProps:{type:Object},cancelButtonProps:{type:Object},footer:{type:Boolean,default:!0},renderToBody:{type:Boolean,default:!0},popupContainer:{type:[String,Object],default:"body"},maskStyle:{type:Object},modalClass:{type:[String,Array]},modalStyle:{type:Object},onBeforeOk:{type:Function},onBeforeCancel:{type:Function},escToClose:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},maskAnimationName:{type:String,default:e=>e.fullscreen?"fade-in-standard":"fade-modal"},modalAnimationName:{type:String,default:e=>e.fullscreen?"zoom-in":"zoom-modal"},bodyClass:{type:[String,Array]},bodyStyle:{type:[String,Object,Array]},messageType:{type:String},hideTitle:{type:Boolean,default:!1}},emits:{"update:visible":e=>!0,ok:e=>!0,cancel:e=>!0,open:()=>!0,close:()=>!0,beforeOpen:()=>!0,beforeClose:()=>!0},setup(e,{emit:o}){const{fullscreen:l,popupContainer:d,alignCenter:r}=He(e),n=Ke("modal"),{t:i}=lo(),p=c(),y=c(),t=c(e.defaultVisible),u=T(()=>{var a;return(a=e.visible)!=null?a:t.value}),m=c(!1),g=T(()=>e.okLoading||m.value),b=T(()=>e.draggable&&!e.fullscreen),{teleportContainer:s,containerRef:B}=no({popupContainer:d,visible:u}),S=c(u.value),w=T(()=>e.okText||i("modal.okText")),k=T(()=>e.cancelText||i("modal.cancelText")),{zIndex:F,isLastDialog:H}=Ge("dialog",{visible:u});let j=!1;const K=a=>{e.escToClose&&a.key===ao.ESC&&H()&&U(a)},N=()=>{e.escToClose&&!j&&(j=!0,R(document.documentElement,"keydown",K))},z=()=>{j=!1,re(document.documentElement,"keydown",K)};let P=0;const{position:C,handleMoveDown:G}=ro({wrapperRef:p,modalRef:y,draggable:b,alignCenter:r}),L=()=>{P++,m.value&&(m.value=!1),t.value=!1,o("update:visible",!1)},Y=async a=>{const h=P,W=await new Promise(async q=>{var ce;if(V(e.onBeforeOk)){let $=e.onBeforeOk((de=!0)=>q(de));if((pe($)||!ye($))&&(m.value=!0),pe($))try{$=(ce=await $)!=null?ce:!0}catch{$=!1}ye($)&&q($)}else q(!0)});h===P&&(W?(o("ok",a),L()):m.value&&(m.value=!1))},U=a=>{var h;let W=!0;V(e.onBeforeCancel)&&(W=(h=e.onBeforeCancel())!=null?h:!1),W&&(o("cancel",a),L())},J=c(!1),Se=a=>{a.target===p.value&&(J.value=!0)},Pe=a=>{e.mask&&e.maskClosable&&J.value&&U(a)},$e=()=>{u.value&&(!Xe(p.value,document.activeElement)&&document.activeElement instanceof HTMLElement&&document.activeElement.blur(),o("open"))},Te=()=>{u.value||(b.value&&(C.value=void 0),S.value=!1,fe(),o("close"))},{setOverflowHidden:ue,resetOverflow:fe}=io(B);Ye(()=>{B.value=We(e.popupContainer),u.value&&(ue(),e.escToClose&&N())}),Re(()=>{fe(),z()}),me(u,a=>{t.value!==a&&(t.value=a),a?(o("beforeOpen"),S.value=!0,J.value=!1,ue(),N()):(o("beforeClose"),z())}),me(l,()=>{C.value&&(C.value=void 0)});const Me=T(()=>[`${n}-wrapper`,{[`${n}-wrapper-align-center`]:e.alignCenter&&!e.fullscreen,[`${n}-wrapper-moved`]:!!C.value}]),De=T(()=>[`${n}`,e.modalClass,{[`${n}-simple`]:e.simple,[`${n}-draggable`]:b.value,[`${n}-fullscreen`]:e.fullscreen}]),Ee=T(()=>{var a;const h=mo({},(a=e.modalStyle)!=null?a:{});return e.width&&!e.fullscreen&&(h.width=ve(e.width)?`${e.width}px`:e.width),!e.alignCenter&&e.top&&(h.top=ve(e.top)?`${e.top}px`:e.top),C.value&&(h.transform=`translate(${C.value[0]}px, ${C.value[1]}px)`),h});return{prefixCls:n,mounted:S,computedVisible:u,containerRef:B,wrapperRef:p,mergedModalStyle:Ee,okDisplayText:w,cancelDisplayText:k,zIndex:F,handleOk:Y,handleCancel:U,handleMaskClick:Pe,handleMaskMouseDown:Se,handleOpen:$e,handleClose:Te,mergedOkLoading:g,modalRef:y,wrapperCls:Me,modalCls:De,teleportContainer:s,handleMoveDown:G}}});function po(e,o,l,d,r,n){const i=M("icon-info-circle-fill"),p=M("icon-check-circle-fill"),y=M("icon-exclamation-circle-fill"),t=M("icon-close-circle-fill"),u=M("icon-close"),m=M("icon-hover"),g=M("arco-button"),b=M("client-only");return f(),D(b,null,{default:A(()=>[(f(),D(Je,{to:e.teleportContainer,disabled:!e.renderToBody},[!e.unmountOnClose||e.computedVisible||e.mounted?Z((f(),E("div",Q({key:0,class:`${e.prefixCls}-container`,style:{zIndex:e.zIndex}},e.$attrs),[I(Ce,{name:e.maskAnimationName,appear:""},{default:A(()=>[e.mask?Z((f(),E("div",{key:0,ref:"maskRef",class:O(`${e.prefixCls}-mask`),style:x(e.maskStyle)},null,6)),[[ee,e.computedVisible]]):v("v-if",!0)]),_:1},8,["name"]),oe("div",{ref:"wrapperRef",class:O(e.wrapperCls),onClick:o[2]||(o[2]=ge((...s)=>e.handleMaskClick&&e.handleMaskClick(...s),["self"])),onMousedown:o[3]||(o[3]=ge((...s)=>e.handleMaskMouseDown&&e.handleMaskMouseDown(...s),["self"]))},[I(Ce,{name:e.modalAnimationName,appear:"",onAfterEnter:e.handleOpen,onAfterLeave:e.handleClose},{default:A(()=>[Z(oe("div",{ref:"modalRef",class:O(e.modalCls),style:x(e.mergedModalStyle)},[!e.hideTitle&&(e.$slots.title||e.title||e.closable)?(f(),E("div",{key:0,class:O(`${e.prefixCls}-header`),onMousedown:o[1]||(o[1]=(...s)=>e.handleMoveDown&&e.handleMoveDown(...s))},[e.$slots.title||e.title?(f(),E("div",{key:0,class:O([`${e.prefixCls}-title`,`${e.prefixCls}-title-align-${e.titleAlign}`])},[e.messageType?(f(),E("div",{key:0,class:O(`${e.prefixCls}-title-icon`)},[e.messageType==="info"?(f(),D(i,{key:0})):v("v-if",!0),e.messageType==="success"?(f(),D(p,{key:1})):v("v-if",!0),e.messageType==="warning"?(f(),D(y,{key:2})):v("v-if",!0),e.messageType==="error"?(f(),D(t,{key:3})):v("v-if",!0)],2)):v("v-if",!0),le(e.$slots,"title",{},()=>[ne(te(e.title),1)])],2)):v("v-if",!0),!e.simple&&e.closable?(f(),E("div",{key:1,tabindex:"-1",role:"button","aria-label":"Close",class:O(`${e.prefixCls}-close-btn`),onClick:o[0]||(o[0]=(...s)=>e.handleCancel&&e.handleCancel(...s))},[I(m,null,{default:A(()=>[I(u)]),_:1})],2)):v("v-if",!0)],34)):v("v-if",!0),oe("div",{class:O([`${e.prefixCls}-body`,e.bodyClass]),style:x(e.bodyStyle)},[le(e.$slots,"default")],6),e.footer?(f(),E("div",{key:1,class:O(`${e.prefixCls}-footer`)},[le(e.$slots,"footer",{},()=>[e.hideCancel?v("v-if",!0):(f(),D(g,Q({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:A(()=>[ne(te(e.cancelDisplayText),1)]),_:1},16,["onClick"])),I(g,Q({type:"primary"},e.okButtonProps,{loading:e.mergedOkLoading,onClick:e.handleOk}),{default:A(()=>[ne(te(e.okDisplayText),1)]),_:1},16,["loading","onClick"])])],2)):v("v-if",!0)],6),[[ee,e.computedVisible]])]),_:3},8,["name","onAfterEnter","onAfterLeave"])],34)],16)),[[ee,e.computedVisible||e.mounted]]):v("v-if",!0)],8,["to","disabled"]))]),_:3})}var X=Ue(vo,[["render",po]]),yo=Object.defineProperty,Co=Object.defineProperties,go=Object.getOwnPropertyDescriptors,he=Object.getOwnPropertySymbols,bo=Object.prototype.hasOwnProperty,wo=Object.prototype.propertyIsEnumerable,Oe=(e,o,l)=>o in e?yo(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,_=(e,o)=>{for(var l in o||(o={}))bo.call(o,l)&&Oe(e,l,o[l]);if(he)for(var l of he(o))wo.call(o,l)&&Oe(e,l,o[l]);return e},ko=(e,o)=>Co(e,go(o));const se=(e,o)=>{let l=Ze("modal");const d=()=>{t.component&&(t.component.props.visible=!1),V(e.onOk)&&e.onOk()},r=()=>{t.component&&(t.component.props.visible=!1),V(e.onCancel)&&e.onCancel()},n=async()=>{await eo(),l&&(be(null,l),document.body.removeChild(l)),l=null,V(e.onClose)&&e.onClose()},i=()=>{t.component&&(t.component.props.visible=!1)},p=u=>{t.component&&Object.entries(u).forEach(([m,g])=>{t.component.props[m]=g})},t=I(X,_(_(_({},{visible:!0,renderToBody:!1,unmountOnClose:!0,onOk:d,onCancel:r,onClose:n}),so(e,["content","title","footer","visible","unmountOnClose","onOk","onCancel","onClose"])),{footer:typeof e.footer=="boolean"?e.footer:void 0}),{default:ae(e.content),title:ae(e.title),footer:typeof e.footer!="boolean"?ae(e.footer):void 0});return(o??Be._context)&&(t.appContext=o??Be._context),be(t,l),document.body.appendChild(l),{close:i,update:p}},ie=_({open:se,confirm:(e,o)=>{const l=_({simple:!0,messageType:"warning"},e);return se(l,o)}},qe.reduce((e,o)=>(e[o]=(l,d)=>{const r=_({simple:!0,hideCancel:!0,messageType:o},l);return se(r,d)},e),{})),Be=Object.assign(X,ko(_({},ie),{install:(e,o)=>{Qe(e,o);const l=xe(o);e.component(l+X.name,X);const d={};for(const r of Object.keys(ie))d[r]=(n,i=e._context)=>ie[r](n,i);e.config.globalProperties.$modal=d},_context:null}));export{Be as M};
